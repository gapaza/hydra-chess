TOKEN LOG PROBS tf.Tensor(
[[-1.1210951e+01 -2.8977349e+00 -5.3285093e+00 -2.9590633e+00
  -9.1455370e-01 -3.3198628e+00 -3.5260422e-03 -2.6762266e+00
  -5.1472287e+00 -3.3235238e+00 -4.0693317e-02 -3.0263557e+00
  -1.5867788e+00 -3.2118666e+00 -5.6235933e+00 -3.8931956e+00
  -3.1592968e+00 -8.4955013e-01 -3.0675874e+00 (-3.0992923e-03) THIS VALUE
  -2.9387136e+00 -1.1164108e-02 -2.8368115e+00 -3.9882450e+00
  -2.6771867e+00 -5.9010285e-01 -2.1948719e+00 -8.7645855e+00
  -8.1906357e+00 -2.1139195e+00 -6.4243784e+00 -4.9524549e-03
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00]
 [-6.7946557e-03 -2.7347324e+00 -5.2624526e+00 -4.5722458e-01
  -2.2091985e+00 -5.5420429e-02 -2.7163541e+00 -1.4921664e-01
  -2.6424806e+00 -8.9045331e-02 -2.6562841e+00 -6.3323345e+00
  -2.6926546e+00 -7.6213412e+00 -2.7731779e+00 -1.3486286e-01
  -2.4367294e+00 -1.4402740e+00 -2.7692432e+00 -6.0553777e-01
  -2.8310978e+00 -4.7657943e-01 -2.8189452e+00 -3.5090101e+00
  -2.9040897e+00 -4.0152812e-01 -2.3473527e+00 -4.1366715e+00
  -1.3144489e-01 -2.5496566e+00 -4.5759523e-01 -2.8860035e+00
  -6.4012969e-01 -2.7500200e+00 -2.8092265e+00 -7.5305647e-01
  -2.8485692e+00 -2.3373601e+00 -2.6848767e+00 -3.6547147e-02
  -2.9082034e+00 -1.8957862e+00 -2.9658191e+00 -5.3158731e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00]], shape=(2, 72), dtype=float32)


OLD PROBS tf.Tensor(
[[-8.4064741e+00 -2.8847075e+00 -5.4477887e+00 -4.8941732e-03
  -3.1695855e+00 -1.1693633e-02 -2.8746603e+00 -7.3014550e+00
  -2.9123490e+00 -1.5819396e-01 -3.1478238e+00 -2.6862277e-02
  -3.1667490e+00 -8.1922989e+00 -1.9580173e+00 -3.3425293e+00
  -1.4486253e-01 -2.7785347e+00 -9.2048731e+00 (-1.0988495e+01) THIS VALUE
  -1.1191606e+01 -1.1254129e+01 -2.7547101e-04 -3.3262198e+00
  -9.4529307e-01 -2.7392747e+00 -5.3076509e-02 -3.0747764e+00
  -2.0002525e+00 -3.2383766e+00 -5.8128405e+00 -2.8882458e+00
  -3.2172122e+00 -2.9910352e-02 -2.5771551e+00 -4.4958010e+00
  -3.0673211e+00 -3.1803527e+00 -3.1032162e+00 -1.5631777e+00
  -2.5349131e+00 -5.2627430e+00 -2.4576677e-01 -2.9843054e+00
  -9.3148124e-01 -2.7945216e+00 -3.7484643e+00 -3.0472045e+00
  -6.6530538e+00 -4.1525289e-02  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]
 [-5.1968792e-03 -2.3007534e+00 -5.5195045e+00 -1.4942751e-02
  -2.6310432e+00 -5.0025411e-02 -2.6683292e+00 -2.0276763e-01
  -2.8105321e+00 -2.1894410e+00 -2.6790385e+00 -5.1407671e-01
  -2.8238575e+00 -3.3469932e+00 -2.8840964e+00 -4.2229033e+00
  -2.9670932e+00 -2.8770101e+00 -2.9246247e+00 -5.5499153e+00
  -1.6665228e-01 -3.0246053e+00 -5.5228810e+00 -3.0279405e+00
  -6.6125994e+00 -9.0351605e-01 -2.9755006e+00 -2.9636553e-01
  -2.9481168e+00 -4.6884027e+00 -6.2584672e+00 -2.2459796e-03
  -2.8064802e+00 -8.9933537e-03 -2.5649145e+00 -3.9458048e+00
  -2.7179186e+00 -1.2154355e-02 -2.4568231e+00 -3.0707026e-01
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]], shape=(2, 72), dtype=float32)


RATIO tf.Tensor(
[[6.05384372e-02 9.87057030e-01 1.12668467e+00 5.21219522e-02
  9.53559685e+00 3.65830921e-02 1.76570358e+01 1.02026070e+02
  1.07005000e-01 4.22002301e-02 2.23568001e+01 4.98123020e-02
  4.85481119e+00 1.45537323e+02 2.55894288e-02 5.76565504e-01
  4.90735881e-02 6.88251781e+00 4.62795685e+02 (5.90060586e+04) THIS VALUE
  3.83870972e+03 7.63410234e+04 5.86283952e-02 5.15805662e-01
  1.76949009e-01 8.57775211e+00 1.17443800e-01 3.38023901e-03
  2.04904191e-03 3.07854509e+00 5.42515874e-01 1.78730392e+01
  2.49584427e+01 1.03036225e+00 1.31596479e+01 8.96399384e+01
  2.14842701e+01 2.40552368e+01 2.22694569e+01 4.77396727e+00
  1.26153345e+01 1.93010193e+02 1.27860141e+00 1.97727642e+01
  2.53826618e+00 1.63548031e+01 4.24558334e+01 2.10563984e+01
  7.75147827e+02 1.04239953e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00]
 [9.98403490e-01 6.47925854e-01 1.29311228e+00 6.42568529e-01
  1.52477169e+00 9.94619489e-01 9.53110099e-01 1.05501080e+00
  1.18299758e+00 8.16940212e+00 1.02301526e+00 2.97277980e-03
  1.14019918e+00 1.39211193e-02 1.11730385e+00 5.96229324e+01
  1.69955051e+00 4.20694256e+00 1.16810334e+00 1.40383423e+02
  6.96379468e-02 1.27818451e+01 1.49384117e+01 6.18121922e-01
  4.07929649e+01 1.65200210e+00 1.87413609e+00 2.14870255e-02
  1.67211075e+01 8.48878574e+00 3.30587646e+02 5.59242256e-02
  8.72637844e+00 6.45040870e-02 7.83243179e-01 2.43552704e+01
  8.77524436e-01 9.77633223e-02 7.96081603e-01 1.31064987e+00
  5.45736924e-02 1.50200203e-01 5.15182503e-02 4.91298735e-03
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
  1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00]], shape=(2, 72), dtype=float32)


MIN ADVANTAGE tf.Tensor(
[[-0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195
  -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195
  -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195
  -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195
  -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195 -0.21378195
  -0.21378195 -0.21378195 -0.         -0.         -0.         -0.
  -0.         -0.         -0.         -0.         -0.         -0.
  -0.         -0.         -0.         -0.         -0.         -0.
  -0.         -0.         -0.         -0.         -0.         -0.
  -0.         -0.         -0.         -0.         -0.         -0.
  -0.         -0.         -0.         -0.         -0.         -0.
  -0.         -0.         -0.         -0.         -0.         -0.        ]
 [ 0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.62763023  0.62763023  0.62763023  0.62763023
   0.62763023  0.62763023  0.          0.          0.          0.
   0.          0.          0.          0.          0.          0.
   0.          0.          0.          0.          0.          0.
   0.          0.          0.          0.          0.          0.
   0.          0.          0.          0.          0.          0.        ]], shape=(2, 72), dtype=float32)


ratio_advantage = ratio * extended_advantage_tensor  # (5, 72)
RATIO ADVANTAGE tf.Tensor(
[[-1.6177531e-02 -2.6376873e-01 -3.0108106e-01 -1.3928416e-02
  -2.5481732e+00 -9.7760065e-03 -4.7184443e+00 -2.7264166e+01
  -2.8594673e-02 -1.1277059e-02 -5.9743505e+00 -1.3311214e-02
  -1.2973387e+00 -3.8891567e+01 -6.8381978e-03 -1.5407412e-01
  -1.3113810e-02 -1.8391976e+00 -1.2367171e+02 (-1.5768038e+04) THIS VALUE: 20th value
  -1.0258086e+03 -2.0400416e+04 -1.5667116e-02 -1.3783742e-01
  -4.7285631e-02 -2.2922108e+00 -3.1384207e-02 -9.0329262e-04
  -5.4756022e-04 -8.2267171e-01 -1.4497513e-01 -4.7761664e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00]
 [ 5.2219015e-01  3.3888152e-01  6.7633027e-01  3.3607951e-01
   7.9749393e-01  5.2021104e-01  4.9850056e-01  5.5179721e-01
   6.1873752e-01  4.2728028e+00  5.3506273e-01  1.5548386e-03
   5.9635288e-01  7.2810957e-03  5.8437800e-01  3.1184294e+01
   8.8890767e-01  2.2003367e+00  6.1094743e-01  7.3424065e+01
   3.6422398e-02  6.6852264e+00  7.8131652e+00  3.2329333e-01
   2.1335747e+01  8.6403865e-01  9.8022032e-01  1.1238255e-02
   8.7455597e+00  4.4398484e+00  1.7290565e+02  2.9249776e-02
   4.5641155e+00  3.3737261e-02  4.0965590e-01  1.2738420e+01
   4.5896736e-01  5.1132675e-02  4.1637069e-01  6.8550283e-01
   2.8543415e-02  7.8558482e-02  2.6945341e-02  2.5696161e-03
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]], shape=(2, 72), dtype=float32)



calc_advantages = tf.minimum(ratio_advantage, min_advantage) --> tf.Tensor(
[[-2.1378195e-01 -2.6376873e-01 -3.0108106e-01 -2.1378195e-01
  -2.5481732e+00 -2.1378195e-01 -4.7184443e+00 -2.7264166e+01
  -2.1378195e-01 -2.1378195e-01 -5.9743505e+00 -2.1378195e-01
  -1.2973387e+00 -3.8891567e+01 -2.1378195e-01 -2.1378195e-01
  -2.1378195e-01 -1.8391976e+00 -1.2367171e+02 (-1.5768038e+04)  THIS VALUE
  -1.0258086e+03 -2.0400416e+04 -2.1378195e-01 -2.1378195e-01
  -2.1378195e-01 -2.2922108e+00 -2.1378195e-01 -2.1378195e-01
  -2.1378195e-01 -8.2267171e-01 -2.1378195e-01 -4.7761664e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00
  -0.0000000e+00 -0.0000000e+00 -0.0000000e+00 -0.0000000e+00]
 [ 5.2219015e-01  3.3888152e-01  6.2763023e-01  3.3607951e-01
   6.2763023e-01  5.2021104e-01  4.9850056e-01  5.5179721e-01
   6.1873752e-01  6.2763023e-01  5.3506273e-01  1.5548386e-03
   5.9635288e-01  7.2810957e-03  5.8437800e-01  6.2763023e-01
   6.2763023e-01  6.2763023e-01  6.1094743e-01  6.2763023e-01
   3.6422398e-02  6.2763023e-01  6.2763023e-01  3.2329333e-01
   6.2763023e-01  6.2763023e-01  6.2763023e-01  1.1238255e-02
   6.2763023e-01  6.2763023e-01  6.2763023e-01  2.9249776e-02
   6.2763023e-01  3.3737261e-02  4.0965590e-01  6.2763023e-01
   4.5896736e-01  5.1132675e-02  4.1637069e-01  6.2763023e-01
   2.8543415e-02  7.8558482e-02  2.6945341e-02  2.5696161e-03
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
   0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00]], shape=(2, 72), dtype=float32)


action_mask_tensor --> tf.Tensor(
[[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
  1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
  1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]], shape=(2, 72), dtype=float32)
--> MINI BATCH LOSS: 584.3528
--> EPOCH LOSSES: 584.3528 [584.3528]